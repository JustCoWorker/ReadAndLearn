

# 7.1　节点发现


## 7.1.2　主节点

* 节点发现
  * 主节点检查所有其他节点，看它们是否有响应，其他节点也ping主节点
  * 主节点接受想加入集群的新节点
  * 主节点跟集群断开连接，其余节点将从中选择一个新的主节点
  * 基于配置自动完成



* 脑裂（split-brain）：有两个（或更多）不会互相连接的集群
  * 一个包含10个节点的集群，一天网络出现故障
  * 有三个节点从集群中断开连接，但它们仍然能互相看见对方
  * 由于zen发现机制和主节点选取的过程，断开的三个节点中选出了一个新的主节点
  * 最终有两个名字相同的集群，各自都有一个主节点
* 把discovery.zen.minimum_master_nodes属性设置为所有可用节点个数50%加1
  * 10台集群设置为6：10/2=5 => 5+1=6